# คำแนะนำการตั้งค่า ESP32 ระบบตรวจจับคน

## ภาพรวมระบบ
```
ESP32 #1 (Camera + AI) → ESP32 #2 (Gateway) → Web Application → Email Notifications
```

## ขั้นตอนการตั้งค่า

### 1. เตรียม ESP32 #2 (Gateway) ก่อน
1. Upload โค้ด `esp32_2_modified.ino` ลง ESP32 #2
2. เปิด Serial Monitor (115200 baud)
3. **จดบันทึก IP Address** ที่แสดงขึ้น เช่น `192.168.1.100`
4. ทดสอบเปิดเบราว์เซอร์ไปที่ IP นั้น จะเห็นหน้าเว็บ Gateway

### 2. แก้ไข IP Address ใน ESP32 #1
1. เปิดไฟล์ `esp32_1_modified.ino`
2. แก้ไขบรรทัดนี้:
   ```cpp
   const char* esp32GatewayIP = "192.168.1.100"; // ใส่ IP ของ ESP32 #2 ที่ได้จากขั้นตอนที่ 1
   ```
3. Upload โค้ดลง ESP32 #1

### 3. ทดสอบระบบ
1. เปิด Serial Monitor ของ ESP32 #1
2. ระบบจะตรวจจับคนทุก 30 วินาที
3. เมื่อตรวจพบคน จะส่งข้อมูลไปยัง ESP32 #2
4. ESP32 #2 จะส่งต่อไปยังเว็บแอป
5. เว็บแอปจะส่งอีเมลแจ้งเตือนอัตโนมัติ

## การแก้ไขปัญหา

### ถ้า ESP32 #1 ไม่สามารถส่งข้อมูลได้
- ตรวจสอบ IP Address ของ ESP32 #2
- ตรวจสอบว่า ESP32 #2 ทำงานอยู่
- ตรวจสอบการเชื่อมต่อ WiFi

### ถ้าไม่ได้รับอีเมลแจ้งเตือน
- ตรวจสอบว่า ESP32 #2 ส่งข้อมูลไปยังเว็บแอปได้หรือไม่
- ตรวจสอบว่ามีอีเมลในระบบหรือไม่
- ตรวจสอบ confidence > 0.5 (50%)

## ข้อมูลเทคนิค

### ESP32 #1 (Camera)
- ใช้ MobileNetV2 AI Model
- ตรวจจับทุก 30 วินาที
- ส่งข้อมูลไปยัง ESP32 #2

### ESP32 #2 (Gateway)
- รับข้อมูลจาก ESP32 #1
- ส่งต่อไปยังเว็บแอป
- แสดงสถานะใน Serial Monitor

### เว็บแอปพลิเคชัน
- รับข้อมูลจาก ESP32 #2
- บันทึกในฐานข้อมูล
- ส่งอีเมลแจ้งเตือนอัตโนมัติ

## การปรับแต่ง

### เปลี่ยนความถี่การตรวจจับ
แก้ไขใน `esp32_1_modified.ino`:
```cpp
const unsigned long capture_interval = 30000; // 30 วินาที
```

### เปลี่ยน Confidence Threshold
แก้ไขใน `esp32_1_modified.ino`:
```cpp
if (strcmp(bb.label, "human") == 0 && bb.value > 0.5) { // 0.5 = 50%
```

### เปลี่ยนข้อมูล Device
แก้ไขใน `esp32_1_modified.ino`:
```cpp
doc["device_id"] = "ESP32_Camera_01";
doc["location"] = "Front Door";
``` 